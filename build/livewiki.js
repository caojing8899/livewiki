!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="/Users/michl/Projects/Playground/Livewiki./build",t(0)}([function(e,t,n){e.exports=n(3)},function(e,t){var n,r,o=function(e,t){return function(){return e.apply(t,arguments)}};r={selectors:{wikipedia:{headline:"#firstHeading",paragraph:"#mw-content-text > p",image:".thumbimage"},term:".livewiki_term",cover:".term__cover",close_button:"button",headline:".headline",headline_overlay:".headline__overlay",paragraph:".term__content",image:".term__image",spinner:".spinner",spinner_image:".spinner__image"}},n=function(){function e(e){this.get_terms=o(this.get_terms,this),this.options={},this.container_element="",Object.assign(this.options,r,e)}return e.prototype.add_term=function(e){return this.terms.push(e)},e.prototype.get_terms=function(){return this.terms},e}(),e.exports=n},function(e,t,n){var r,o,i=function(e,t){return function(){return e.apply(t,arguments)}},s=function(e,t){function n(){this.constructor=e}for(var r in t)u.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},u={}.hasOwnProperty;o=n(1),r=function(e){function t(){this.find_element=i(this.find_element,this);var e,n;return t.__super__.constructor.call(this),this.container_element="",e=document.querySelector("body"),n=this.find_or_create(),n.id="livewiki",n.addEventListener("click",function(e){return function(e){return e.stopPropagation()}}(this)),n.addEventListener("mouseover",function(t){return function(n){var r;if(r=document.querySelector(t.options.selectors.paragraph),n.target.classList.contains(t.options.selectors.paragraph.substr(1))&&r.clientHeight>=200)return e.style.overflow="hidden"}}(this)),n.addEventListener("mouseout",function(t){return function(n){if(n.target.classList.contains(t.options.selectors.paragraph.substr(1)))return e.style.overflow="scroll"}}(this)),document.querySelector("body").appendChild(n),n}return s(t,e),t.prototype.find_or_create=function(){return this.container_element=this.find_element(),this.container_element||(this.container_element=document.createElement("div")),this.container_element},t.prototype.find_element=function(){return document.querySelector("#livewiki")},t.prototype.remove_container=function(){var e;if(e=this.find_element())return e.remove()},t.prototype.remove_terms=function(){var e;if(e=this.find_element())return e.innerHTML=""},t}(o),e.exports=r},function(e,t,n){var r,o,i,s;n(13),o=n(1),r=n(2),i=n(4),n(5),n(7),n(9),n(10),n(11),n(8),n(6),(s=function(e){return"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)})(function(){var e,t;return t=!1,document.addEventListener("keyup",function(e){return function(e){if(console.log("which ",e.which),console.log("ctrlKey ",e.ctrlKey),console.log("keyCode ",e.keyCode),(27===e.which||91===e.which||93===e.which||17===e.which||e.ctrlKey)&&!t)return r.prototype.remove_container()}}(this)),document.querySelector("body").addEventListener("click",function(e){return r.prototype.remove_container()}),e=document.querySelectorAll('a[href^="/wiki/"]:not(.new)'),Array.prototype.forEach.call(e,function(e,n){var r;return r="",e.addEventListener("mouseover",function(e){var n;return t=!0,n=e.target.getAttribute("href"),r=new i(n),document.addEventListener("keyup",r.display),r.preload().then(function(e){},function(e){return console.log(e)})}),e.addEventListener("mouseout",function(e){return t=!1,document.removeEventListener("keyup",r.display)})})})},function(e,t,n){var r,o,i,s,u,c,a=function(e,t){return function(){return e.apply(t,arguments)}},l=function(e,t){function n(){this.constructor=e}for(var r in t)p.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},p={}.hasOwnProperty;u=new DOMParser,o=n(1),r=n(2),c=n(12),i=function(e){function t(e){this.display_term=a(this.display_term,this),this.set_values=a(this.set_values,this),this.to_html=a(this.to_html,this),this.html_element=a(this.html_element,this),this.update_html=a(this.update_html,this),this.remove_term=a(this.remove_term,this),this.display=a(this.display,this),this.preload=a(this.preload,this),t.__super__.constructor.call(this),this.link=e,this.loaded=!1,this.displayed=!1,this.container=new r,this.headline="",this.paragraph="",this.image_src=""}return l(t,e),t.prototype.preload=function(){return new Promise(function(e){return function(t,n){var r;return e.html_element()?(t(e),!1):(r=new XMLHttpRequest,r.open("GET",e.link,!0),r.onload=function(){var o,i,s,c,a;return 200===r.status?(c=r.responseText,a=u.parseFromString(c,"text/html"),o=a.querySelector(e.options.selectors.wikipedia.headline),e.headline=o?o.textContent:"Error",s=a.querySelector(e.options.selectors.wikipedia.paragraph),s&&s.textContent.length>5?e.paragraph=s.textContent:s||(s=a.querySelector("p"),e.paragraph=s?s.textContent:e.paragraph="Sorry, we couldn't crawl that page."),i=a.querySelector(e.options.selectors.wikipedia.image),i&&(e.image_src=i.getAttribute("src")),e.displayed&&e.update_html(),e.display_term(document),e.loaded=!0,t(e)):n(Error("Term didn't load successfully; error code: "+r.statusText))},r.onerror=function(){return n(Error("There was a network error."))},r.send())}}(this))},t.prototype.display=function(e){return!this.html_element()&&(r.prototype.remove_terms(),91===e.which||93===e.which||17===e.which?this.append():void 0)},t.prototype.append=function(){var e;return e=this.to_html(),this.loaded&&this.display_term(e),this.displayed=!0,this.container.appendChild(e)},t.prototype.remove_term=function(){return this.html_element().remove()},t.prototype.update_html=function(){var e;return e=this.html_element(),this.set_values(e)},t.prototype.html_element=function(){return document.querySelector("[data-href='"+encodeURIComponent(this.link)+"']")},t.prototype.to_html=function(){var e,t,n,r,o,i,s,a,l;return l=u.parseFromString(c,"text/html"),e=l.querySelector(this.options.selectors.close_button),n=l.querySelector(this.options.selectors.term),t=l.querySelector(this.options.selectors.cover),r=l.querySelector(this.options.selectors.headline),o=l.querySelector(this.options.selectors.headline_overlay),i=l.querySelector(this.options.selectors.image),a=l.querySelector(this.options.selectors.spinner_image),a.setAttribute("src",chrome.extension.getURL("spinner.gif")),this.set_values(l),this.image_src?(i.src=this.image_src,t.classList.add("cover--default_size")):null!==(s=this.image_src)&&""!==s||(r.classList.add("color--black"),i.remove(),o.remove()),e.addEventListener("click",this.remove_term),n.setAttribute("data-href",encodeURIComponent(this.link)),n},t.prototype.set_values=function(e){var t,n,r;if(t=e.querySelector(this.options.selectors.headline),t&&(t.textContent=this.headline),r=e.querySelector(this.options.selectors.paragraph),r&&(r.textContent=this.paragraph),n=e.querySelector(this.options.selectors.image),n&&this.image_src)return n.src=this.image_src},t.prototype.display_term=function(e){var t,n,r;if(this.displayed=!0,t=e.querySelector(this.options.selectors.cover),t&&t.classList.remove("element--hidden"),n=e.querySelector(this.options.selectors.paragraph),n&&n.classList.remove("element--hidden"),r=e.querySelector(this.options.selectors.spinner))return r.classList.add("element--hidden")},t}(o),s=function(e,t,n){for(;e.parentElement;)if(e=e.parentElement,e.tagName.toLowerCase()===t.toLowerCase()&&e.classList.contains(n))return e},e.exports=i},function(e,t){},function(e,t,n){e.exports=n.p+"manifest.json"},function(e,t,n){e.exports=n.p+"spinner.gif"},function(e,t,n){e.exports=n.p+"icons/black/128x128.png"},function(e,t,n){e.exports=n.p+"icons/black/16x16.png"},function(e,t,n){e.exports=n.p+"icons/black/32x32.png"},function(e,t,n){e.exports=n.p+"icons/black/48x48.png"},function(e,t){e.exports='<div class=livewiki_term data-href=""> <div class=term__header> <h2 class=livewiki__logo> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjIuMSwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA1MDAgODQuMyIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTAwIDg0LjMiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8Zz4KCTxnPgoJCTxwYXRoIGZpbGw9IiMzQTNBM0EiIGQ9Ik01LjEsNjQuOGg4LjJWMTkuMUg1LjFWNC43SDQwdjE0LjRoLTguMnY0NC43aDE1LjhWNTNINjN2MjUuMkg1LjFWNjQuOHoiLz4KCQk8cGF0aCBmaWxsPSIjM0EzQTNBIiBkPSJNNzMuNiw2NS4zaDYuN1YzOC4xaC03LjJWMjUuMmgyNXY0MC4xaDYuN3YxMi45SDczLjZWNjUuM3ogTTgwLjUsNC43aDE3LjR2MTMuOUg4MC41VjQuN3oiLz4KCQk8cGF0aCBmaWxsPSIjM0EzQTNBIiBkPSJNMTExLjksMjUuMkgxNDB2MTIuOWgtNC43bDYuMSwxOS4xYzEuMSwzLjIsMS40LDcsMS40LDdoMC40YzAsMCwwLjMtMy44LDEuNC03bDYuMS0xOS4xSDE0NlYyNS4yaDI4LjIKCQkJdjEyLjloLTZsLTE0LjcsNDAuMWgtMjFsLTE0LjctNDAuMWgtNlYyNS4yeiIvPgoJCTxwYXRoIGZpbGw9IiMzQTNBM0EiIGQ9Ik0yMDkuMywyNGMxNS44LDAsMjQuNywxMC45LDI0LjcsMjUuNmMwLDEuNy0wLjQsNS4zLTAuNCw1LjNIMjAwYzEuMyw2LjgsNi43LDkuOCwxMi4zLDkuOAoJCQljNy44LDAsMTQuOS01LDE0LjktNWw2LjUsMTIuM2MwLDAtOC41LDcuNC0yMi44LDcuNGMtMTguOSwwLTI5LjEtMTMuNy0yOS4xLTI3LjhDMTgxLjgsMzYuMSwxOTIuMywyNCwyMDkuMywyNHogTTIxNS42LDQ1LjIKCQkJYzAtNC4yLTIuOC03LjgtNi43LTcuOGMtNS4xLDAtNy42LDMuNy04LjUsNy44SDIxNS42eiIvPgoJCTxwYXRoIGZpbGw9IiMzQTNBM0EiIGQ9Ik0yMzguNyw0LjdoMzIuNlYxOGgtOC41bDYuOCwzMi42YzAuNywzLjYsMC45LDcuNywwLjksNy43aDAuNGMwLDAsMC4zLTQuMSwxLjItNy43bDExLjMtNDZoMTQuMmwxMS4zLDQ2CgkJCWMwLjksMy42LDEuMiw3LjcsMS4yLDcuN2gwLjRjMCwwLDAuMi00LjEsMC45LTcuN2w2LjgtMzIuNmgtOC41VjQuN2gzMi42VjE4aC02LjJsLTE0LjYsNjAuMWgtMjAuM0wyOTIsNDAuNQoJCQljLTAuOS0zLjYtMS4yLTguMS0xLjItOC4xaC0wLjRjMCwwLTAuMyw0LjUtMS4yLDguMWwtOS40LDM3LjZoLTIwLjNMMjQ0LjksMThoLTYuMlY0Ljd6Ii8+CgkJPHBhdGggZmlsbD0iIzNBM0EzQSIgZD0iTTM1MC43LDY1LjNoNi43VjM4LjFoLTcuMlYyNS4yaDI1djQwLjFoNi43djEyLjloLTMxLjJWNjUuM3ogTTM1Ny42LDQuN0gzNzV2MTMuOWgtMTcuNFY0Ljd6Ii8+CgkJPHBhdGggZmlsbD0iIzNBM0EzQSIgZD0iTTM5MS43LDY1LjNoNi43VjE3LjVoLTcuMlY0LjdoMjV2NDAuMmg2LjFsNS42LTYuOGgtNVYyNS4yaDI3LjZ2MTIuOWgtNi41bC05LjIsMTEuMXYwLjIKCQkJYzAsMCwyLjMsMS4xLDQuMiw0LjdsNS4yLDkuNWMwLjgsMS40LDEuOSwxLjcsMy45LDEuN2gyLjZ2MTIuOWgtMTNjLTMuOCwwLTUuOC0wLjYtNy42LTRsLTguMS0xNWMtMC45LTEuNy0yLjktMS43LTQuMi0xLjdoLTEuNQoJCQl2Ny45aDMuOHYxMi45aC0yOC4zVjY1LjN6Ii8+CgkJPHBhdGggZmlsbD0iIzNBM0EzQSIgZD0iTTQ2Mi40LDY1LjNoNi43VjM4LjFoLTcuMlYyNS4yaDI1djQwLjFoNi43djEyLjloLTMxLjJWNjUuM3ogTTQ2OS4zLDQuN2gxNy40djEzLjloLTE3LjRWNC43eiIvPgoJPC9nPgo8L2c+Cjwvc3ZnPgo="/> </h2> <button class="header__icon term--close">CLOSE</button> </div> <div class=spinner> <img class=spinner__image alt=Loading> </div> <div class="term__cover element--hidden"> <h1 class=headline></h1> <div class=headline__overlay></div> <img class=term__image> </div> <p class="term__content element--hidden"></p> </div>'},function(e,t){"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");e=Object(e);for(var t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e})}]);